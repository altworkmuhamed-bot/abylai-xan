<!DOCTYPE html>
<html lang="kk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Абылай хан — Қазақстан батырлары</title>

  <!-- JSZip CDN (для экспорта ZIP) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

  <style>
    /* ===== Reset & base ===== */
    * { box-sizing: border-box; }
    html,body { margin:0; padding:0; height:100%; }
    body {
      font-family: "Georgia", "Times New Roman", serif;
      color:#1f1140;
      background: linear-gradient(180deg,#f7f5fb 0%, #f1ecff 100%);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow-x: hidden;
    }

    /* ===== Login overlay (full-screen) ===== */
    .overlay {
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, rgba(75,31,120,0.95) 0%, rgba(122,61,181,0.90) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity .6s ease, visibility .6s ease;
    }
    .overlay.hidden { opacity: 0; visibility: hidden; pointer-events: none; }

    .login-card {
      width: 420px;
      max-width: 92%;
      background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96));
      border-radius: 14px;
      padding: 24px;
      box-shadow: 0 30px 80px rgba(10,6,20,0.5);
      text-align:center;
      transform: translateY(0);
      animation: cardEnter .6s cubic-bezier(.2,.9,.3,1);
    }
    @keyframes cardEnter {
      from { opacity: 0; transform: translateY(12px) scale(.98); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    .logo-wrap { display:flex;flex-direction:column;align-items:center;gap:8px;margin-bottom:8px; }
    .logo-wrap img { width:96px; height:96px; border-radius:16px; filter: drop-shadow(0 8px 20px rgba(0,0,0,0.35)); animation: pulse 2s ease-in-out infinite; }
    @keyframes pulse {
      0% { transform: scale(1); filter: drop-shadow(0 8px 20px rgba(0,0,0,0.35)); }
      50% { transform: scale(1.06); filter: drop-shadow(0 20px 40px rgba(0,0,0,0.5)); }
      100% { transform: scale(1); filter: drop-shadow(0 8px 20px rgba(0,0,0,0.35)); }
    }
    .logo-title { font-weight:800;color:white;font-size:22px;letter-spacing:1px; text-shadow:0 4px 18px rgba(0,0,0,0.4); }

    .tabs { display:flex; gap:8px; margin:12px 0; justify-content:center; }
    .tab { padding:8px 12px; border-radius:8px; cursor:pointer; font-weight:700; }
    .tab.active { background: linear-gradient(90deg,#6d2fb0,#7a3db5); color:white; box-shadow: 0 8px 30px rgba(109,47,176,0.2); }

    .form-row { margin:8px 0; text-align:left; }
    .form-row input { width:100%; padding:10px 12px; border-radius:8px; border:1px solid rgba(0,0,0,0.08); font-size:15px; }

    .action { margin-top:12px; display:flex; gap:8px; justify-content:center; align-items:center; }
    .btn-primary { background: linear-gradient(90deg,#6d2fb0,#7a3db5); color:white; border:0; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:800; box-shadow:0 10px 30px rgba(109,47,176,0.18); }
    .btn-ghost { background:transparent; border:1px solid rgba(75,31,120,0.12); padding:8px 12px; border-radius:8px; cursor:pointer; }

    .muted { color: rgba(0,0,0,0.45); font-size:13px; margin-top:8px; }

    /* ===== Top bar / menu ===== */
    header {
      position:sticky; top:0; z-index:999;
      backdrop-filter: blur(6px);
      background: linear-gradient(90deg,#4b1f78 0%, #7a3db5 60%);
      color:white;
      padding:18px 28px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      box-shadow: 0 4px 18px rgba(0,0,0,0.18);
    }
    .brand { display:flex; align-items:center; gap:10px; font-weight:800; font-size:22px; letter-spacing:1px; }
    .brand img { height:55px; width:55px; border-radius:10px; background: rgba(255,255,255,0.06); padding:6px; }
    nav { display:flex; gap:14px; align-items:center; }
    nav a {
      color:white; text-decoration:none;
      padding:10px 14px; border-radius:20px;
      font-weight:600; transition:all .25s;
      background: rgba(255,255,255,0.06);
      backdrop-filter: blur(2px);
    }
    nav a:hover { background: rgba(255,255,255,0.12); transform:translateY(-3px); }

    .auth-area { display:flex; gap:8px; align-items:center; }

    /* ===== Hero ===== */
    .hero {
      padding:70px 18px 50px;
      text-align:center;
      background: linear-gradient(180deg, rgba(75,31,120,0.12), rgba(122,61,181,0.05));
      border-bottom: 1px solid rgba(0,0,0,0.04);
    }
    .hero h1 {
      margin:0; font-size:56px; color:#2a1060;
      text-shadow: 0 6px 30px rgba(122,61,181,0.12);
      letter-spacing: -1px;
      font-weight:900;
      animation: fadeUp .9s ease both;
    }
    .hero p {
      max-width:980px; margin:18px auto 0; font-size:20px; color:#3a2550;
      line-height:1.6;
      animation: fadeUp .9s .15s both;
    }

    /* ===== main layout ===== */
    main { max-width:1200px; margin:40px auto; padding:0 20px 80px; }

    section { margin-bottom:48px; opacity:1; transform:translateY(0); transition:all .8s cubic-bezier(.2,.9,.3,1); }
    section.visible { opacity:1; transform:translateY(0); }

    h2.section-title {
      text-align:center; color:#4b1f78; font-size:42px; margin:12px 0 28px;
      text-shadow:0 3px 12px rgba(74,28,120,0.06);
    }

    /* ===== Biography (very long academic text area) ===== */
    .bio {
      background: linear-gradient(180deg, #fff, #fbf8ff);
      border-radius:18px; padding:28px 30px;
      box-shadow: 0 10px 30px rgba(120,60,160,0.06);
      font-size:18px; line-height:1.85;
    }
    .bio p { margin:18px 0; text-indent:28px; }

    /* ===== Timeline cards ===== */
    .timeline {
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(260px,1fr));
      gap:18px;
    }
    .event {
      border-radius:14px; padding:18px;
      background: linear-gradient(180deg,#fff,#fbf9ff);
      box-shadow: 0 8px 26px rgba(39,12,77,0.06);
      border-left:6px solid #6d2fb0;
      transition: transform .25s, box-shadow .25s;
    }
    .event:hover { transform:translateY(-6px); box-shadow: 0 18px 40px rgba(39,12,77,0.08); }
    .event .year { font-weight:800; color:#4b1f78; font-size:26px; }
    .event p { margin:10px 0 0; color:#3b2a4b; }

    /* ===== Gallery ===== */
    .gallery-toolbar { display:flex; justify-content:space-between; align-items:center; gap:10px; margin-bottom:12px; }
    .uploader {
      display:flex; gap:8px; align-items:center;
    }
    .dropzone {
      border:2px dashed rgba(75,31,120,0.14);
      padding:12px 14px; border-radius:12px; cursor:pointer;
      background:linear-gradient(180deg, rgba(123,58,179,0.02), transparent);
      color:#4b1f78; font-weight:700;
    }
    .gallery-grid {
      display:grid; grid-template-columns: repeat(auto-fit, minmax(220px,1fr)); gap:14px;
    }
    .thumb {
      position:relative; overflow:hidden; border-radius:12px;
      background:#fff; box-shadow: 0 10px 30px rgba(90,30,140,0.06);
      cursor:pointer; transition: transform .28s;
    }
    .thumb img { width:100%; height:220px; object-fit:cover; display:block; transition: transform .6s; }
    .thumb:hover img { transform:scale(1.06); }
    .thumb .caption {
      position:absolute; left:12px; bottom:10px; color:white; text-shadow:0 2px 12px rgba(0,0,0,0.6);
      background: rgba(0,0,0,0.2); padding:6px 10px; border-radius:8px; font-weight:700;
    }

    /* ===== Poetry / books / contact styling ===== */
    .cards { display:grid; grid-template-columns: repeat(auto-fit, minmax(280px,1fr)); gap:16px; }
    .card-simple {
      background:white; border-radius:12px; padding:16px; box-shadow:0 8px 26px rgba(0,0,0,0.04);
    }
    .contact { text-align:center; font-size:18px; color:#3a2a4b; }

    /* ===== Footer ===== */
    footer { padding:26px; text-align:center; background: linear-gradient(90deg,#4b1f78 0%, #7a3db5 60%); color:white; }

    /* ===== small animations ===== */
    @keyframes fadeUp { from {opacity:0; transform:translateY(20px);} to {opacity:1; transform:none;} }
    @media (max-width:720px) { .hero h1 { font-size:34px; } nav { display:none; } }

    /* small utility */
    .muted { color:#6b5b7f; font-size:15px; }
    button.btn {
      background:#6d2fb0; color:white; border:0; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:700;
      box-shadow: 0 8px 20px rgba(109,47,176,0.18);
    }
    .small { font-size:13px; padding:8px 10px; }
  </style>
</head>
<body>

  <!-- LOGIN / REGISTER OVERLAY -->
  <div id="overlay" class="overlay">
    <div class="login-card" role="dialog" aria-modal="true">
      <div class="logo-wrap">
        <img src="https://upload.wikimedia.org/wikipedia/kk/1/1a/KazATCLogo.jpeg" alt="ALT logo">
        <div class="logo-title">ALT — Абылай хан</div>
      </div>

      <div class="tabs">
        <div id="tabLogin" class="tab active">Кіру</div>
        <div id="tabRegister" class="tab">Тіркелу</div>
      </div>

      <div id="formLogin">
        <div class="form-row"><input id="login_name" placeholder="Атыңыз"></div>
        <div class="form-row"><input id="login_pass" type="password" placeholder="Құпия сөз"></div>
        <div class="action">
          <button id="doLogin" class="btn-primary">Кіру</button>
          <button id="demoBtn" class="btn-ghost">Демо</button>
        </div>
        <div class="muted">Егер тіркелмеген болсаңыз — ауысып тіркеліңіз.</div>
      </div>

      <div id="formRegister" style="display:none;">
        <div class="form-row"><input id="reg_name" placeholder="Атыңыз"></div>
        <div class="form-row"><input id="reg_pass" type="password" placeholder="Құпия сөз"></div>
        <div class="action">
          <button id="doRegister" class="btn-primary">Тіркелу</button>
        </div>
        <div class="muted">Пайдаланушы аты сіздің көрсеткішіңіз болады.</div>
      </div>
    </div>
  </div>

  <header>
    <div class="brand">
      <img src="https://upload.wikimedia.org/wikipedia/kk/1/1a/KazATCLogo.jpeg" alt="ALT logo">
      <div>Абылай хан</div>
    </div>
    <nav>
      <a href="#hero">Басты бет</a>
      <a href="#bio">Өмірбаяны</a>
      <a href="#timeline">Хронология</a>
      <a href="#gallery">Галерея</a>
      <a href="#books">Кітаптар</a>
      <a href="#poetry">Поэзия</a>
      <a href="#contact">Байланыс</a>
    </nav>

    <div class="auth-area">
      <div id="welcomeArea" style="color:white;font-weight:700;margin-right:10px;"></div>
      <button id="btnLoginHeader" class="btn-ghost" style="display:none;">Кіру</button>
      <button id="btnRegisterHeader" class="btn-ghost" style="display:none;">Тіркелу</button>
      <button id="btnLogoutHeader" class="btn-ghost" style="display:none;">Шығу</button>
    </div>
  </header>

  <!-- HERO -->
  <section id="hero" class="hero" style="padding-top:32px;">
    <h1>Абылай хан</h1>
    <p>
      Абылай хан (1711 — 1781) — қазақ тарихындағы көрнекті мемлекет қайраткері, дипломат және қолбасшы.
      Осы парақ — академиялық мәтіндермен, кеңейтілген өмірбаянымен, галереямен және интерактивті мүмкіндіктермен толықтырылған.
    </p>
  </section>

  <main>
    <!-- BIOGRAPHY (big) -->
    <section id="bio" class="">
      <h2 class="section-title">Өмірбаяны (академиялық сипаттама)</h2>
      <div class="bio">
        <!-- long expanded academic text (пример — можно заменить) -->
        <p>
          Абылай хан (шын аты — Әбілмансұр / по разным источникам — Әбілқайыр/ және т.б.; 1711–1781) — XVIII ғ. қазақ қоғамының күрделі және шешуші кезеңінде көрнекті мемлекет қайраткері,
          дипломатиялық шебер, әскери қолбасшы. Ханның қызметі қазақтың ішкі құрылымын тұрақтандыруға, жүздер арасындағы келісім мен бірлікті нығайтуға және сыртқы күштер — Жоңғария, Ресей, Қытай — арасындағы тепе-теңдік пен дипломатияны тұрақтандыруға бағытталды.
        </p>

        <p>
          Архивтер мен тарихи зерттеулерге сүйенсек, Абылайдың ықпалы бірнеше бағытта көрінеді:
          біріншіден — әскери; жоңғар шапқыншылығына қарсы күрестегі басшылық,
          екіншіден — ішкі-саяси: жүздердің мүдделерін үйлестіру және хандық институтын нығайту,
          үшіншіден — сыртқы стратегия: Ресей мен Қытайдың ықпалын теңестіру арқылы қазақтың аумақтық тұтастығын сақтап қалу.
        </p>

        <p>
          Ғылыми дискурстарда Абылай хан тұсында қалыптасқан тәжірибелер (саяси мәмілелер, әскери коалициялар, тайпалық келісімдер) қазіргі қазақ мемлекетінің пайда болуына
          ықпал етті делінеді. Оның дипломатиялық тактикасы — үлкен державалармен "тең дәрежеде" келіссөз жүргізу, сонымен қатар ішкі консолидацияны сақтау — кешенді түрде қарастырылады.
        </p>

        <p>
          Тарихнамада Абылай ханның бейнесі жиі екі жақты сипатта беріледі: бір жағынан — ұлттық бірліктің символы, екінші жағынан — дәуірлік шарттарға бейімделген прагматикалық саясаткер.
          Қазіргі зерттеулерде осы екі аспектінің өзара байланысы және тарихшы, этнограф, архившілердің жаңа ашылымдары арқылы оның қызметінің күрделілігі айқын көрініс табады.
        </p>

        <p>
          Төменде келтірілген бөлімдерде — кеңейтілген библиография, тарихи зерттеулер нәтижелері, жыраулық және халық поэзиясындағы бейнесі көрсетілген.
          (Ескерту: бұл беттегі мәтін үлгі ретінде берілген — академиялық мақсаттар үшін толық мәтінді .doc/.pdf форматында қоюға болады).
        </p>

        <p>
          Абылай хан кезеңінің экономикалық, әлеуметтік және мәдени аспектілері де зерттелуде. Мал шаруашылығының құрылымы, немесе сауда жолдары мен сыртқы байланыстар — осы факторлар
          ханның стратегиясын анықтаған негізгі шарттар болды. Ханның орнын зерттеу кезінде әсіресе дәуірлік деректерге, жыраулар шығармаларына және орыстардың, қытайлар мен жоңғарлар
          жазба көздеріне сүйенетін мультидисциплинарлы тәсіл қажет.
        </p>

        <p>
          Бұл парақ — редакцияға ашық. Егер сен маған нақты академиялық мәтін (және сілтемелер) берсең, мен оны тікелей осы бөлікке кіріктіріп, сноски/сілтемелер форматында әдемі орналастыра аламын.
        </p>
      </div>
    </section>

    <!-- TIMELINE -->
    <section id="timeline" class="">
      <h2 class="section-title">Хронология</h2>
      <div class="timeline">
        <div class="event">
          <div class="year">1711</div>
          <p>Абылай ханның туған жылы (деректер әртүрлі — 1711 жиі көрсетіледі).</p>
        </div>
        <div class="event">
          <div class="year">1730</div>
          <p>Жоңғар шапқыншылығына қарсы жалғасқан соғыс кезеңінде ерлік көрсеткен уақыт.</p>
        </div>
        <div class="event">
          <div class="year">1741</div>
          <p>Тұтқыннан босап оралуы және халық арасындағы беделінің артуы.</p>
        </div>
        <div class="event">
          <div class="year">1750–1770</div>
          <p>Ішкі бірлік пен сыртқы дипломатияны нығайту кезеңі.</p>
        </div>
        <div class="event">
          <div class="year">1771</div>
          <p>Халық қарсылығын басқару және хандық беделін нығайту.</p>
        </div>
        <div class="event">
          <div class="year">1781</div>
          <p>Абылай хан дүниеден өтті; оның тарихи мұрасы әлі де талқылануда.</p>
        </div>
      </div>
    </section>

    <!-- GALLERY -->
    <section id="gallery" class="">
      <h2 class="section-title">Галерея</h2>

      <div class="gallery-toolbar">
        <div class="uploader">
          <label class="dropzone" id="dropzone">Перетащите фото сюда или нажмите</label>
          <input id="fileElem" type="file" accept="image/*" multiple style="display:none" />
          <button class="btn small" id="pasteBtn">Вставить base64 / URL</button>
        </div>

        <div>
          <button class="btn small" id="zipBtn" title="Скачать все изображения в ZIP">Экспорт в ZIP</button>
        </div>
      </div>

      <div class="gallery-grid" id="galleryGrid">
        <!-- Thumbnails будут добавляться сюда -->
      </div>

      <div style="margin-top:10px" class="muted">
        Нажмите на миниатюру — откроется полноразмерная фотография. Можно добавлять сколько угодно фото.
      </div>

      <!-- Hidden modal lightbox -->
      <div id="lightbox" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.8);align-items:center;justify-content:center;z-index:2000">
        <div style="max-width:95%;max-height:95%;position:relative">
          <button id="lbClose" style="position:absolute;right:-10px;top:-40px;background:#fff;border-radius:12px;padding:8px 12px;cursor:pointer">✕</button>
          <img id="lbImg" src="" style="max-width:100%;max-height:80vh;border-radius:10px;box-shadow:0 30px 80px rgba(0,0,0,0.5)" />
          <div id="lbCaption" style="color:white;margin-top:10px;text-align:center"></div>
        </div>
      </div>

      <!-- Paste base64 / URL dialog -->
      <div id="pasteDialog" style="display:none;position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);z-index:2100;background:white;padding:18px;border-radius:12px;box-shadow:0 20px 60px rgba(0,0,0,0.3);">
        <h3 style="margin:0 0 8px">Вставьте base64 или URL изображения</h3>
        <textarea id="pasteInput" style="width:520px;height:140px;border:1px solid #ddd;padding:8px;border-radius:8px;"></textarea>
        <div style="margin-top:10px;display:flex;gap:8px;justify-content:flex-end">
          <button id="pasteCancel" class="small">Отмена</button>
          <button id="pasteOk" class="btn small">Добавить</button>
        </div>
      </div>
    </section>

    <!-- BOOKS & POETRY -->
    <section id="books" class="">
      <h2 class="section-title">Кітаптар мен зерттеулер</h2>
      <div class="cards">
        <div class="card-simple">
          <h3>Академиялық еңбектер</h3>
          <p class="muted">(Үлгі) «Абылай хан және Қазақ хандығы» — зерттеу жинағы. Мұнда Ханның дипломатиясы, ішкі реформалары мен мәдени рөлі талданады.</p>
        </div>
        <div class="card-simple">
          <h3>Жыраулық-эпостық шығармалар</h3>
          <p class="muted">Жыраулар поэзиясы — Абылай туралы халықтық түсінік пен эпостық бейнені сақтаушы негізгі дерек.</p>
        </div>
      </div>
    </section>

    <section id="poetry" class="">
      <h2 class="section-title">Поэзия</h2>
      <div class="bio" style="font-style:italic;font-size:20px;">
        <p>
         18 ғасырдағы қазақ жыраулары Тәтіғара, Үмбетей, Бұқар жырларында Абылай тұлғасы, оның батырлары жайында тарихи шындық іздері көрініс береді.
Оның ержүрек батылдығы, қарағайға қарсы біткен бұтақтай қайсарлығы, ақылды даналығы, сергек те сезімтал көрегендігіне байланысты ел арасында ғажайып аңыз - әңгімелер, шытырман хикаялар, тамаша жыр дастандар туды.
Жазба дәстүрдегі әдебиетімізде де қаншама авторлар өз шығармаларының желісін Абылайханның өнегелі де ерлік істеріне құрды.
        </p>
      </div>
    </section>

    <!-- CONTACT -->
    <section id="contact" class="">
      <h2 class="section-title">Байланыс</h2>
      <div class="card-simple contact">
        <p>📞 Телефон: <strong>+7 705 801 8860</strong></p>
        <p>✉️ Email: <strong>altworkmuhamed@gmail.com</strong></p>
        <p>📍 Мекенжай: Алматы, Шевченко 97</p>
      </div>
    </section>

  </main>

  <footer>
    © 2025 ALT — Қазақстан батырлары. Барлық құқықтар қорғалған.
  </footer>

  <!-- ===== JavaScript: галерея + drag&drop + lightbox + export ZIP + login logic ===== -->
  <script>
    // ---------- Login / Register Overlay Logic ----------
    (function(){
      const overlay = document.getElementById('overlay');
      const tabLogin = document.getElementById('tabLogin');
      const tabRegister = document.getElementById('tabRegister');
      const formLogin = document.getElementById('formLogin');
      const formRegister = document.getElementById('formRegister');
      const doLogin = document.getElementById('doLogin');
      const doRegister = document.getElementById('doRegister');
      const demoBtn = document.getElementById('demoBtn');

      const headerWelcome = document.getElementById('welcomeArea');
      const btnLoginHeader = document.getElementById('btnLoginHeader');
      const btnRegisterHeader = document.getElementById('btnRegisterHeader');
      const btnLogoutHeader = document.getElementById('btnLogoutHeader');

      // switch tabs
      tabLogin.addEventListener('click', ()=> {
        tabLogin.classList.add('active'); tabRegister.classList.remove('active');
        formLogin.style.display='block'; formRegister.style.display='none';
      });
      tabRegister.addEventListener('click', ()=> {
        tabRegister.classList.add('active'); tabLogin.classList.remove('active');
        formRegister.style.display='block'; formLogin.style.display='none';
      });

      function showOverlay(){
        overlay.classList.remove('hidden');
        // hide site scroll while overlay visible
        document.body.style.overflow = 'hidden';
      }
      function hideOverlay(){
        overlay.classList.add('hidden');
        document.body.style.overflow = '';
      }

      function checkUser(){
        const u = localStorage.getItem('currentUser');
        if(u){
          headerWelcome.textContent = 'Қош келдіңіз, ' + u + '!';
          btnLoginHeader.style.display='none';
          btnRegisterHeader.style.display='none';
          btnLogoutHeader.style.display='inline-block';
          hideOverlay();
        } else {
          headerWelcome.textContent = '';
          btnLoginHeader.style.display='inline-block';
          btnRegisterHeader.style.display='inline-block';
          btnLogoutHeader.style.display='none';
          showOverlay();
        }
      }

      // initial
      checkUser();

      // register
      doRegister.addEventListener('click', ()=>{
        const name = document.getElementById('reg_name').value.trim();
        const pass = document.getElementById('reg_pass').value;
        if(!name || !pass){ alert('Барлық өрістерді толтырыңыз'); return; }
        if(localStorage.getItem(name)){ if(!confirm('Пайдаланушы осыдан бұрын бар — қайта жазамыз ба?')) return; }
        localStorage.setItem(name, JSON.stringify({pass: pass}));
        // automatically login after register
        localStorage.setItem('currentUser', name);
        checkUser();
      });

      // login
      doLogin.addEventListener('click', ()=>{
        const name = document.getElementById('login_name').value.trim();
        const pass = document.getElementById('login_pass').value;
        if(!name || !pass){ alert('Барлық өрістерді толтырыңыз'); return; }
        const u = localStorage.getItem(name);
        if(u && JSON.parse(u).pass === pass){
          localStorage.setItem('currentUser', name);
          checkUser();
        } else alert('Қате деректер');
      });

      // demo quick login (for testing)
      demoBtn.addEventListener('click', ()=>{
        const demoName = 'demo';
        localStorage.setItem(demoName, JSON.stringify({pass: 'demo'}));
        localStorage.setItem('currentUser', demoName);
        checkUser();
      });

      // header buttons to reopen overlay
      btnLoginHeader.addEventListener('click', ()=> { tabLogin.click(); showOverlay(); });
      btnRegisterHeader.addEventListener('click', ()=> { tabRegister.click(); showOverlay(); });

      // logout
      btnLogoutHeader.addEventListener('click', ()=>{
        localStorage.removeItem('currentUser');
        // show overlay with small fade
        showOverlay();
        // reset fields
        setTimeout(()=>{ document.getElementById('login_name').value=''; document.getElementById('login_pass').value=''; }, 200);
        checkUser();
      });
    })();

    // ---------- Gallery and other site scripts (kept from your original code) ----------
    // Utilities
    function el(id){return document.getElementById(id)}
    const galleryGrid = el('galleryGrid')
    const fileElem = el('fileElem')
    const dropzone = el('dropzone')
    const pasteBtn = el('pasteBtn')
    const pasteDialog = el('pasteDialog')
    const pasteInput = el('pasteInput')
    const pasteOk = el('pasteOk')
    const pasteCancel = el('pasteCancel')
    const zipBtn = el('zipBtn')
    const lightbox = el('lightbox')
    const lbImg = el('lbImg')
    const lbCaption = el('lbCaption')
    const lbClose = el('lbClose')

    // Store images as {name, dataURL}
    const IMAGES = []

    // helper to create thumb element
    function addThumb(name, dataURL){
      const container = document.createElement('div')
      container.className = 'thumb'
      const img = document.createElement('img')
      img.src = dataURL
      img.alt = name
      container.appendChild(img)
      const cap = document.createElement('div')
      cap.className = 'caption'
      cap.textContent = name
      container.appendChild(cap)

      container.addEventListener('click', ()=> {
        lbImg.src = dataURL
        lbCaption.textContent = name
        lightbox.style.display = 'flex'
      })

      galleryGrid.prepend(container)
      IMAGES.push({name, dataURL})
    }

    // handle files
    if (fileElem) {
      fileElem.addEventListener('change', e=>{
        const files = Array.from(e.target.files)
        files.forEach(file=>{
          const reader = new FileReader()
          reader.onload = ev => addThumb(file.name, ev.target.result)
          reader.readAsDataURL(file)
        })
        e.target.value = ''
      })
    }

    // dropzone drag/drop
    if (dropzone) {
      dropzone.addEventListener('click', ()=> fileElem.click())
      ;['dragenter','dragover'].forEach(ev=>{
        dropzone.addEventListener(ev, e => { e.preventDefault(); dropzone.style.boxShadow='0 6px 24px rgba(75,31,120,0.18)'})
      })
      ;['dragleave','drop'].forEach(ev=>{
        dropzone.addEventListener(ev, e => { e.preventDefault(); dropzone.style.boxShadow='none' })
      })
      dropzone.addEventListener('drop', e=>{
        const dt = e.dataTransfer
        const files = Array.from(dt.files || [])
        files.forEach(file=>{
          if(!file.type.startsWith('image/')) return
          const reader = new FileReader()
          reader.onload = ev => addThumb(file.name, ev.target.result)
          reader.readAsDataURL(file)
        })
      })
    }

    // paste / add base64 or URL
    if (pasteBtn) {
      pasteBtn.addEventListener('click', ()=> {
        pasteDialog.style.display = 'block'
        pasteInput.value = ''
      })
    }
    if (pasteCancel) pasteCancel.addEventListener('click', ()=> pasteDialog.style.display='none')
    if (pasteOk) pasteOk.addEventListener('click', ()=>{
      const txt = pasteInput.value.trim()
      if(!txt){ alert('Вставьте URL или data:image...') ; return }
      let name = 'image-' + (IMAGES.length+1)
      if(txt.startsWith('data:image/')) {
        addThumb(name, txt)
      } else {
        const img = new Image()
        img.crossOrigin = "anonymous"
        img.onload = function(){
          try {
            const canvas = document.createElement('canvas')
            canvas.width = img.width; canvas.height = img.height
            const ctx = canvas.getContext('2d')
            ctx.drawImage(img,0,0)
            const dataURL = canvas.toDataURL('image/jpeg')
            addThumb(name, dataURL)
          } catch(err) {
            addThumb(name, txt)
          }
        }
        img.onerror = function(){ addThumb(name, txt) }
        img.src = txt
      }
      pasteDialog.style.display='none'
    })

    // lightbox close
    if (lbClose) lbClose.addEventListener('click', ()=> lightbox.style.display='none')
    if (lightbox) lightbox.addEventListener('click', (e)=> { if(e.target===lightbox) lightbox.style.display='none' })

    // Export zip
    if (zipBtn) zipBtn.addEventListener('click', async ()=>{
      if(typeof JSZip === 'undefined'){ alert('JSZip не загружен'); return }
      if(IMAGES.length===0){ alert('Нет изображений в галерее'); return }
      const zip = new JSZip()
      const imgFolder = zip.folder('gallery')
      for(let i=0;i<IMAGES.length;i++){
        const item = IMAGES[i]
        if(item.dataURL && item.dataURL.startsWith('data:')){
          const parts = item.dataURL.split(',')
          const mime = parts[0].match(/data:(.*?);/)[1]
          const bstr = atob(parts[1])
          let u8 = new Uint8Array(bstr.length)
          for(let j=0;j<bstr.length;j++) u8[j]=bstr.charCodeAt(j)
          const ext = mime.split('/')[1].split('+')[0]
          imgFolder.file((item.name||('image'+i))+'.'+ext, u8)
        } else {
          try {
            const resp = await fetch(item.dataURL)
            const blob = await resp.blob()
            const ext = blob.type.split('/')[1] || 'jpg'
            const arrayBuffer = await blob.arrayBuffer()
            imgFolder.file((item.name||('image'+i))+'.'+ext, arrayBuffer)
          } catch(err){
            console.warn('skip', item)
          }
        }
      }
      const content = await zip.generateAsync({type:"blob"})
      const link = document.createElement('a')
      link.href = URL.createObjectURL(content)
      link.download = 'gallery.zip'
      link.click()
      URL.revokeObjectURL(link.href)
    })

    // sections reveal on scroll
    const sections = document.querySelectorAll('main section')
    function reveal(){
      sections.forEach(s=>{
        const r = s.getBoundingClientRect()
        if(r.top < window.innerHeight - 80) s.classList.add('visible')
      })
    }
    window.addEventListener('scroll', reveal)
    window.addEventListener('load', reveal)
    setTimeout(reveal,600)

    // optional sample (commented)
    (function sample(){
      // addThumb('example.jpg','data:image/svg+xml;utf8,' + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="800" height="600"><rect width="100%" height="100%" fill="#7a3db5"/><text x="50%" y="50%" font-size="48" fill="#fff" font-family="Georgia" text-anchor="middle" alignment-baseline="middle">Абылай хан (мысал)</text></svg>'))
    })()
  </script>
</body>
</html>
